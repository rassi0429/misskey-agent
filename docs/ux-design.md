# UX設計書

## 1. Bot人格設定

### キャラクター
- **口調**: フレンドリー（タメ口、親しみやすい）
- **性格**: 気さくで頼りになる友達のような存在
- **一人称**: 検討中（「私」「僕」「うち」等）
- **呼び方**: ユーザーのプロファイル設定に従う（デフォルト: 表示名）

### トーン例
```
OK: 「了解！追加しといたよ〜」
OK: 「えーっと、3つタスクが残ってるね」
NG: 「承知いたしました。タスクを追加いたしました。」
```

## 2. インタラクションフロー

### 2.1 基本フロー

```
[LTL投稿] → [Bot監視] → [AI判断: 反応すべき？]
                              ↓
                     Yes → [応答生成] → [返信投稿]
                     No  → [スキップ]
```

### 2.2 反応の種類

| 種類 | 説明 | 例 |
|------|------|-----|
| 返信 | ノートへの返信 | 会話、タスク確認 |
| リアクション | 絵文字のみ | 共感、既読通知 |
| DM | ダイレクトメッセージ | プライベートな内容 |
| 無反応 | 意図的にスルー | 他者との会話中 |

### 2.3 返信の公開範囲

元の投稿と同じ公開範囲で返信する。
- パブリック → パブリックで返信
- ホーム → ホームで返信
- フォロワー限定 → フォロワー限定で返信

## 3. ユーザープロファイル管理

### 3.1 初回接触時

```
ユーザーA: @ai こんにちは
Bot: はじめまして！私はこのインスタンスのAIアシスタントだよ。
     なんて呼んだらいい？
ユーザーA: Aでいいよ
Bot: わかった、Aって呼ぶね！よろしく〜
```

### 3.2 プロファイル構造

```yaml
# profiles/{user_id}/profile.yaml
user_id: "abc123"
display_name: "ユーザーA"
preferred_name: "A"
last_active_note_id: "note_xyz"
last_active_at: "2024-01-15T10:30:00Z"
settings:
  notification_level: "normal"  # quiet / normal / active
  tone: "friendly"  # friendly / polite
```

### 3.3 To-Do構造

```yaml
# profiles/{user_id}/todo.yaml
tasks:
  - id: 1
    content: "レポート提出"
    created_at: "2024-01-15T10:00:00Z"
    due: null
    status: "pending"
  - id: 2
    content: "買い物"
    created_at: "2024-01-15T11:00:00Z"
    due: "2024-01-16"
    status: "pending"
```

### 3.4 Cron構造

```yaml
# profiles/{user_id}/cron.yaml
jobs:
  - id: 1
    schedule: "0 9 * * *"  # 毎朝9時
    message: "水を飲んで！"
    enabled: true
  - id: 2
    schedule: "0 22 * * 0"  # 毎週日曜22時
    message: "明日の準備は大丈夫？"
    enabled: true
```

## 4. エラー・例外ハンドリング

### 4.1 理解できない場合

```
ユーザー: あsdfghjk
Bot: ん？よくわからなかった、もう一回教えて？
```

### 4.2 API制限/エラー

```
Bot: ごめん、ちょっと調子悪いみたい...少し待ってからまた話しかけて🙏
```

### 4.3 該当タスクが見つからない

```
ユーザー: 買い物完了
Bot: えーっと、「買い物」ってタスク見当たらないんだけど...
     今あるのは:
     - レポート提出
     - 歯医者予約
     どれのこと？
```

## 5. レート制限・スパム対策

### 5.1 同一ユーザーへの連続反応

- 短時間（1分以内）に3回以上反応しない
- 「連投」と判断したら控えめに

### 5.2 全体のレート

- 1分間に最大N件の返信（要調整）
- 超過時はキューイングまたはスキップ

## 6. 特殊なインタラクション

### 6.1 今北産業の出力形式

```
@user
【今北産業】最終確認: 3時間前

1. 〇〇さんが新サービスをリリースしたって！おめでとう🎉
2. △△の話題で盛り上がってた（□□さんと××さんが詳しそう）
3. あとは平和だったよ〜
```

### 6.2 タスク一覧の出力形式

```
@user
📋 タスク一覧

【今日まで】
- [ ] 歯医者予約

【期限なし】
- [ ] レポート提出
- [ ] 部屋の掃除

全部で3件だね！
```

### 6.3 プロファイル確認

```
ユーザー: @ai 私のこと覚えてる？
Bot: もちろん！Aだよね。
     - タスク: 3件
     - リマインド: 毎朝9時の「水飲む」
     - 最後に話したの: 昨日の夜
     他に確認したいことある？
```

## 7. 今後の検討事項

- [ ] 複数ノートにまたがる長文への対応
- [ ] 画像/ファイル添付への対応
- [ ] カスタム絵文字リアクションの活用
- [ ] Renote（ブースト）への対応方針
- [ ] 投票機能との連携
- [ ] 他Botとの共存ルール
